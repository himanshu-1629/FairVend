<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FairVend - Breaking Barriers to Essential Goods</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <script>
        // Support for dark mode in Tailwind
        tailwind.config = {
          darkMode: 'class',
        }
    </script>
    <style>
        /* Custom styles */
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        #map {
            height: 500px;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            z-index: 10;
        }
        .leaflet-popup-content-wrapper {
            background-color: #fff;
            color: #333;
        }
        .dark .leaflet-popup-content-wrapper {
            background-color: #1f2937;
            color: #f3f4f6;
        }
        /* Dark mode filter for map tiles (optional, but good for visual consistency) */
        .dark .leaflet-tile-pane {
             filter: brightness(0.6) invert(1) contrast(3) hue-rotate(200deg) saturate(0.3) brightness(0.7);
        }
        /* Style for the CAPTCHA text */
        #captcha-text {
            user-select: none;
            text-decoration: line-through;
            font-style: italic;
        }
        /* Style for the user's location marker */
        .user-location-marker {
            filter: hue-rotate(180deg);
        }

        /* --- Creative Header Styles --- */
        .nav-link {
            position: relative;
            transition: color 0.3s ease;
        }
        .nav-link:hover {
            color: #4f46e5; /* indigo-600 */
        }
        .dark .nav-link:hover {
            color: #818cf8; /* indigo-400 */
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #6366f1; /* indigo-500 */
            transition: width 0.3s ease;
        }
        .dark .nav-link::after {
            background-color: #818cf8; /* indigo-400 */
        }
        .nav-link:hover::after {
            width: 100%;
        }

        .header-scrolled {
            background-color: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .dark .header-scrolled {
            background-color: rgba(15, 23, 42, 0.95); /* slate-900 */
        }
        .header-scrolled nav {
            padding-top: 0.75rem; /* py-3 */
            padding-bottom: 0.75rem; /* py-3 */
        }
        
        /* --- Static Gradient Styles --- */
        .btn-gradient {
            background-size: 100% auto;
            transition: filter 0.3s ease;
        }
        .btn-gradient:hover {
            filter: brightness(110%);
        }
        .btn-gradient-green {
             background-image: linear-gradient(to right, #4ade80, #34d399, #22c55e);
        }
        .btn-gradient-indigo {
             background-image: linear-gradient(to right, #818cf8, #6366f1, #4f46e5);
        }
        .card-gradient-indigo {
            background: linear-gradient(135deg, #ffffff 50%, #eef2ff); /* white to indigo-50 */
        }
        .dark .card-gradient-indigo {
             background: linear-gradient(135deg, #1f2937 50%, #312e81); /* slate-800 to indigo-900 */
        }
        .card-gradient-green {
            background: linear-gradient(135deg, #ffffff 50%, #f0fdf4); /* white to green-50 */
        }
        .dark .card-gradient-green {
             background: linear-gradient(135deg, #1f2937 50%, #14532d); /* slate-800 to green-900 */
        }
        .card-gradient-amber {
            background: linear-gradient(135deg, #ffffff 50%, #fffbeb); /* white to amber-50 */
        }
        .dark .card-gradient-amber {
             background: linear-gradient(135deg, #1f2937 50%, #78350f); /* slate-800 to amber-900 */
        }
        .slider-track {
            transition: transform 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 dark:bg-slate-900 dark:text-slate-200 transition-colors duration-300">
    
    <div id="language-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[100] p-4">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-8 max-w-sm w-full text-center">
            <h3 class="text-2xl font-bold text-slate-900 dark:text-white" data-key="chooseLangTitle">Choose Your Language</h3>
            <p class="mt-2 text-slate-600 dark:text-slate-300" data-key="chooseLangSubtitle">Please select your preferred language.</p>
        
            <div class="mt-6 flex flex-col gap-4">
                <button class="lang-select-btn w-full bg-indigo-600 text-white font-semibold py-3 rounded-lg hover:bg-indigo-700 transition" data-lang="en">English</button>
                <button class="lang-select-btn w-full bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 font-semibold py-3 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 transition" data-lang="hi">हिन्दी (Hindi)</button>
                <button class="lang-select-btn w-full bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 font-semibold py-3 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 transition" data-lang="ta">தமிழ் (Tamil)</button>
          
            </div>
        </div>
    </div>


    <header class="bg-white/80 dark:bg-slate-900/80 backdrop-blur-lg sticky top-0 z-50 transition-all duration-300">
        <nav class="container mx-auto px-6 py-5 flex justify-between items-center transition-all duration-300">
            <div class="flex-1 flex justify-start">
                <a href="#" class="flex items-center gap-2 text-2xl font-bold">
                    <svg class="w-8 h-8 text-indigo-600 dark:text-indigo-400" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.001 4.52853C14.35 2.42 17.98 2.49 20.2426 4.75736C22.5053 7.02472 22.583 10.6356 20.4786 12.993L11.9999 21.485L3.52138 12.993C1.41705 10.6356 1.49472 7.02472 3.75736 4.75736C6.02 2.49 9.64999 2.42 12.001 4.52853Z"></path></svg>
                    <span class="hidden sm:inline text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-blue-500 dark:from-indigo-400 dark:to-blue-400">FairVend</span>
                </a>
            </div>
          
            <div class="hidden lg:flex items-center space-x-10 text-sm font-medium text-slate-600 dark:text-slate-300">
                <a href="#how-it-works" class="nav-link" data-key="navHowItWorks">How It Works</a>
                <a href="#impact" class="nav-link" data-key="navImpact">Impact</a>
                <a href="#find-machine" id="header-find-machine-btn-desktop" class="nav-link" data-key="navFindMachine">Find Nearest Machine</a>
            </div>

            <div class="flex-1 flex justify-end items-center gap-3 sm:gap-4">
                 <a href="#donate" class="bg-indigo-600 text-white font-semibold px-4 sm:px-5 py-2.5 rounded-lg hover:bg-indigo-700 transition-all shadow-sm hover:shadow-md text-sm" data-key="navDonateNow">Donate Now</a>
                
                 <div class="relative">
                    <button id="settings-button" class="p-2 rounded-md text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700">
                         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                    </button>
                    <div id="settings-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-slate-800 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50">
                        <div class="px-4 py-2 text-xs font-semibold text-slate-400" data-key="prefLang">Language</div>
                        <a href="#" class="block px-4 py-2 text-sm text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 lang-select-btn" data-lang="en">English</a>
                        <a href="#" class="block px-4 py-2 text-sm text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 lang-select-btn" data-lang="hi">हिन्दी</a>
                        <a href="#" class="block px-4 py-2 text-sm text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 lang-select-btn" data-lang="ta">தமிழ்</a>
                        <div class="border-t border-slate-200 dark:border-slate-700 my-1"></div>
                        <div class="px-4 py-2 text-xs font-semibold text-slate-400" data-key="prefTheme">Theme</div>
                        <div class="flex justify-around py-1">
                            <button id="theme-light-btn" class="theme-select-btn p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 transition">
                                <svg class="w-5 h-5 text-slate-700 dark:text-slate-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                            </button>
                             <button id="theme-dark-btn" class="theme-select-btn p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700 transition">
                                <svg class="w-5 h-5 text-slate-700 dark:text-slate-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                            </button>
                        </div>
                    </div>
                </div>

                 <button id="mobile-menu-button" class="lg:hidden text-slate-600 dark:text-slate-300 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
        </nav>
        <div id="mobile-menu" class="hidden lg:hidden px-6 pb-4">
            <a href="#how-it-works" class="block py-2 text-slate-600 dark:text-slate-300" data-key="navHowItWorks_mobile">How It Works</a>
            <a href="#impact" class="block py-2 text-slate-600 dark:text-slate-300" data-key="navImpact_mobile">Impact</a>
            <a href="#find-machine" id="header-find-machine-btn-mobile" class="block py-2 text-slate-600 dark:text-slate-300" data-key="navFindMachine_mobile">Find Nearest Machine</a>
        </div>
    </header>

    
    <main>
        <section class="relative bg-slate-800">
            <div class="absolute inset-0">
                <img src="https://images.unsplash.com/photo-1593113598332-cd288d649433?q=80&w=2070&auto=format&fit=crop" alt="A person giving food to someone in need" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-slate-900/70"></div>
            </div>
            <div class="relative container mx-auto px-6 py-24 md:py-40 text-center text-white">
                <div class="flex justify-center items-center gap-4">
                    <div class="bg-white/10 backdrop-blur-sm rounded-full px-4 py-2 text-sm font-medium" data-key="fundedAmount">₹2.5M+ Funded</div>
                    <div class="bg-white/10 backdrop-blur-sm rounded-full px-4 py-2 text-sm font-medium" data-key="livesImpacted">50,000+ Lives Impacted</div>
                </div>
                <h1 class="mt-8 text-4xl md:text-6xl font-extrabold leading-tight">
                    <span data-key="heroTitle1">Breaking</span> <span class="text-amber-400" data-key="heroTitle2">Barriers</span> <span data-key="heroTitle3">to Essential Goods</span>
                </h1>
                <p class="mt-6 max-w-3xl mx-auto text-lg text-slate-300" data-key="heroSubtitle">Color-coded discount cards connecting those in need to affordable essentials. Your donation helps us provide up to 50% discounts at vending machines across the community.</p>
                <div class="mt-10 flex flex-col sm:flex-row justify-center items-center gap-4">
                    <a href="#find-machine" id="find-nearest-btn" class="w-full sm:w-auto btn-gradient btn-gradient-indigo text-white font-semibold px-8 py-3 rounded-lg shadow-md hover:shadow-lg transform hover:-translate-y-1" data-key="heroBtnFind">Find Nearest Machine</a>
                    <a href="#donate" class="w-full sm:w-auto bg-slate-100/20 text-white font-semibold px-8 py-3 rounded-lg hover:bg-slate-100/30 transition-all ring-1 ring-inset ring-white/30 shadow-sm hover:shadow-md" data-key="heroBtnDonate">Make a Donation</a>
                </div>
            </div>
        </section>
        
        <section id="impact" class="py-20 md:py-28 bg-gradient-to-b from-slate-50 to-white dark:from-slate-900 dark:to-slate-800/50">
            <div class="container mx-auto px-6">
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-white" data-key="impactTitle">Our Collective Impact</h2>
                    <p class="mt-4 max-w-2xl mx-auto text-slate-600 dark:text-slate-300" data-key="impactSubtitle">Transparency is at the heart of what we do. See how your contributions are making a tangible difference in real-time.</p>
                </div>
                <div class="max-w-4xl mx-auto mt-16 grid grid-cols-1 md:grid-cols-2 gap-8 text-center">
                    <div class="bg-slate-100 dark:bg-slate-800 p-8 rounded-2xl">
                        <div class="text-5xl font-extrabold text-indigo-600 dark:text-indigo-400">₹2.5M+</div>
                        <div class="mt-2 text-lg font-semibold text-slate-700 dark:text-slate-300" data-key="impactFundsTitle">Total Funds Raised</div>
                        <p class="mt-2 text-slate-500 dark:text-slate-400" data-key="impactFundsDesc">From thousands of generous donors across the country.</p>
                    </div>
                    <div class="bg-slate-100 dark:bg-slate-800 p-8 rounded-2xl">
                        <div class="text-5xl font-extrabold text-green-600 dark:text-green-400">50,000+</div>
                        <div class="mt-2 text-lg font-semibold text-slate-700 dark:text-slate-300" data-key="impactPeopleTitle">Individuals Supported</div>
                        <p class="mt-2 text-slate-500 dark:text-slate-400" data-key="impactPeopleDesc">Provided with essential goods through our vending network.</p>
                    </div>
                </div>

                <div class="mt-20">
                    <h3 class="text-2xl md:text-3xl font-bold text-center text-slate-900 dark:text-white" data-key="testimonialsTitle">Stories from Our Community</h3>
                    <div class="relative max-w-2xl mx-auto mt-8">
                        <div class="overflow-hidden">
                            <div id="slider-track" class="flex slider-track">
                                <div class="w-full flex-shrink-0 px-4">
                                    <div class="bg-white dark:bg-slate-800 p-8 rounded-2xl shadow-lg text-center">
                                        <div class="text-amber-400 flex justify-center gap-1 mb-4">
                                            <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
                                        </div>
                                        <p class="text-slate-600 dark:text-slate-300 italic" data-key="testimonial1Text">"As a student, every rupee matters. The FairVend card has been a blessing, helping me buy snacks and essentials without worrying. It feels like someone cares."</p>
                                        <div class="mt-4 font-bold text-slate-800 dark:text-slate-100" data-key="testimonial1Name">- Ananya, Student from Mumbai</div>
                                    </div>
                                </div>
                                <div class="w-full flex-shrink-0 px-4">
                                    <div class="bg-white dark:bg-slate-800 p-8 rounded-2xl shadow-lg text-center">
                                        <div class="text-amber-400 flex justify-center gap-1 mb-4">
                                            <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
                                        </div>
                                        <p class="text-slate-600 dark:text-slate-300 italic" data-key="testimonial2Text">"After a long day of work, having access to affordable drinks and sanitary products for my daughter is a huge relief. Thank you, FairVend, for your support."</p>
                                        <div class="mt-4 font-bold text-slate-800 dark:text-slate-100" data-key="testimonial2Name">- Rajesh, Worker from Delhi</div>
                                    </div>
                                </div>
                                <div class="w-full flex-shrink-0 px-4">
                                    <div class="bg-white dark:bg-slate-800 p-8 rounded-2xl shadow-lg text-center">
                                        <div class="text-amber-400 flex justify-center gap-1 mb-4">
                                            <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
                                        </div>
                                        <p class="text-slate-600 dark:text-slate-300 italic" data-key="testimonial3Text">"The dignity this program provides is immeasurable. Getting essentials for my family without feeling like I'm asking for a handout has made all the difference."</p>
                                        <div class="mt-4 font-bold text-slate-800 dark:text-slate-100" data-key="testimonial3Name">- Priya, Mother from Chennai</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button id="prev-slide" class="absolute top-1/2 -translate-y-1/2 left-0 -translate-x-12 p-2 rounded-full bg-white/50 dark:bg-slate-700/50 hover:bg-white dark:hover:bg-slate-700 transition">
                            <svg class="w-6 h-6 text-slate-700 dark:text-slate-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                        </button>
                        <button id="next-slide" class="absolute top-1/2 -translate-y-1/2 right-0 translate-x-12 p-2 rounded-full bg-white/50 dark:bg-slate-700/50 hover:bg-white dark:hover:bg-slate-700 transition">
                            <svg class="w-6 h-6 text-slate-700 dark:text-slate-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                        </button>
                    </div>
                </div>

            </div>
        </section>

        <section id="how-it-works" class="py-20 md:py-28">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-white" data-key="howTitle">A Simple System for a Big Impact</h2>
                <p class="mt-4 max-w-2xl mx-auto text-slate-600 dark:text-slate-300" data-key="howSubtitle">We believe in direct, transparent, and dignified support. Here’s how our color-coded discount system works.</p>
                <div class="mt-16 grid grid-cols-1 md:grid-cols-3 gap-10 md:gap-8">
                    <div class="card-gradient-indigo p-8 rounded-2xl shadow-lg hover:shadow-xl dark:hover:shadow-indigo-500/10 transition-shadow transform hover:-translate-y-2">
                        <div class="bg-indigo-100 dark:bg-indigo-900/50 text-indigo-600 dark:text-indigo-400 w-16 h-16 rounded-full flex items-center justify-center mx-auto">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg>
                        </div>
                        <h3 class="mt-6 text-xl font-bold dark:text-white" data-key="howStep1Title">Get Your Card</h3>
                        <p class="mt-2 text-slate-500 dark:text-slate-400" data-key="howStep1Desc">In partnership with local NGOs, we distribute FairVend cards. Each color represents a different level of support.</p>
                    </div>
                    <div class="card-gradient-green p-8 rounded-2xl shadow-lg hover:shadow-xl dark:hover:shadow-green-500/10 transition-shadow transform hover:-translate-y-2">
                        <div class="bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 w-16 h-16 rounded-full flex items-center justify-center mx-auto">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>
                        </div>
                        <h3 class="mt-6 text-xl font-bold dark:text-white" data-key="howStep2Title">Scan the Color</h3>
                        <p class="mt-2 text-slate-500 dark:text-slate-400" data-key="howStep2Desc">Simply show your card to the vending machine's scanner. Our system instantly recognizes and applies the discount.</p>
                    </div>
                    <div class="card-gradient-amber p-8 rounded-2xl shadow-lg hover:shadow-xl dark:hover:shadow-amber-500/10 transition-shadow transform hover:-translate-y-2">
                        <div class="bg-amber-100 dark:bg-amber-900/50 text-amber-600 dark:text-amber-400 w-16 h-16 rounded-full flex items-center justify-center mx-auto">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M12 6h.01M6 12h.01M18 12h.01M7 7h.01M17 7h.01M7 17h.01M17 17h.01"></path></svg>
                        </div>
                        <h3 class="mt-6 text-xl font-bold dark:text-white" data-key="howStep3Title">Receive Your Discount</h3>
                        <p class="mt-2 text-slate-500 dark:text-slate-400" data-key="howStep3Desc">Your discount is funded by generous donors, providing essential items at a more affordable price.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="find-machine" class="py-20 md:py-28 bg-slate-100 dark:bg-slate-800">
            <div class="container mx-auto px-6">
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-white" data-key="findTitle">Find a FairVend Machine Near You</h2>
                    <p class="mt-4 max-w-2xl mx-auto text-slate-600 dark:text-slate-300" data-key="findSubtitle">Enter your area or city to locate the closest machine and get directions.</p>
                </div>

                <div class="max-w-xl mx-auto mt-10 p-4 bg-white dark:bg-slate-700 rounded-xl shadow-lg">
                     <form id="search-form" class="flex flex-col sm:flex-row gap-3">
                        <input type="text" id="location-input" class="flex-grow p-3 border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-800 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-slate-800 dark:text-slate-200" placeholder="Enter city or landmark (e.g., Delhi, Central Park)" data-key="searchPlaceholder" required>
                        <button type="submit" id="search-btn" class="flex-shrink-0 btn-gradient btn-gradient-green text-white font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all" data-key="searchBtn">Search Location</button>
                    </form>
                </div>

                <div id="map" class="mt-10"></div>
                
                <div id="no-location-alert" class="hidden mt-6 p-4 text-center bg-yellow-100 dark:bg-yellow-900 border border-yellow-300 dark:border-yellow-700 text-yellow-800 dark:text-yellow-200 rounded-lg">
                    <p><strong>Note:</strong> We couldn't find a FairVend machine near your searched location. We are constantly expanding our network!</p>
                </div>
            </div>
        </section>

        <section id="donate" class="py-20 md:py-28">
            <div class="container mx-auto px-6">
                 <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-white" data-key="donationTitle">Be The Change</h2>
                    <p class="mt-4 max-w-2xl mx-auto text-slate-600 dark:text-slate-300" data-key="donationSubtitle">Your donation today directly funds essential items for someone in need.</p>
                </div>

                <div class="max-w-2xl mx-auto mt-12 bg-white dark:bg-slate-800 p-8 md:p-10 rounded-2xl shadow-2xl">
                    <form id="donation-form" class="space-y-6">
                        
                        <div>
                            <label class="block text-sm font-medium text-slate-700 dark:text-slate-300" data-key="donateAmount">Select Donation Amount (INR)</label>
                            <div class="mt-2 grid grid-cols-2 sm:grid-cols-4 gap-3">
                                <button type="button" class="donation-amount-btn py-3 rounded-lg text-slate-800 dark:text-slate-200 font-semibold bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 transition" value="100">₹100</button>
                                <button type="button" class="donation-amount-btn py-3 rounded-lg text-slate-800 dark:text-slate-200 font-semibold bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 transition" value="500">₹500</button>
                                <button type="button" class="donation-amount-btn py-3 rounded-lg text-slate-800 dark:text-slate-200 font-semibold bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 transition" value="1000">₹1000</button>
                                <button type="button" class="donation-amount-btn py-3 rounded-lg text-slate-800 dark:text-slate-200 font-semibold bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 transition" value="5000">₹5000</button>
                            </div>
                        </div>

                        <div>
                            <input type="number" id="custom-amount" class="w-full p-3 border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 rounded-lg text-slate-800 dark:text-slate-200 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Custom Amount" data-key="customAmountPlaceholder">
                        </div>
                        
                        <div>
                            <label for="donor-name" class="block text-sm font-medium text-slate-700 dark:text-slate-300" data-key="donateName">Your Name</label>
                            <input type="text" id="donor-name" class="mt-1 w-full p-3 border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 rounded-lg text-slate-800 dark:text-slate-200 focus:ring-indigo-500 focus:border-indigo-500" required>
                        </div>
                        <div>
                            <label for="donor-email" class="block text-sm font-medium text-slate-700 dark:text-slate-300" data-key="donateEmail">Your Email</label>
                            <input type="email" id="donor-email" class="mt-1 w-full p-3 border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 rounded-lg text-slate-800 dark:text-slate-200 focus:ring-indigo-500 focus:border-indigo-500" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-slate-700 dark:text-slate-300" data-key="captchaLabel">Enter the CAPTCHA Text</label>
                            <div class="mt-1 flex items-center gap-3">
                                <span id="captcha-text" class="text-2xl font-bold px-4 py-2 bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 rounded-lg select-none"></span>
                                <input type="text" id="captcha-input" class="flex-grow p-3 border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-900 rounded-lg text-slate-800 dark:text-slate-200 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Type text here" data-key="captchaPlaceholder" required>
                            </div>
                        </div>

                        <button type="submit" id="donate-btn" class="w-full btn-gradient btn-gradient-indigo text-white font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all flex items-center justify-center" data-key="donateBtnSecure">
                            Donate Securely
                        </button>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <div id="thank-you-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[100] p-4">
        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-8 max-w-sm w-full text-center relative">
            <button id="close-modal-btn" class="absolute top-4 right-4 text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
            <div id="thank-you-content">
                <h3 class="text-2xl font-bold text-green-600 dark:text-green-400" data-key="thankYouTitle">Thank You!</h3>
                <p class="mt-2 text-slate-600 dark:text-slate-300" data-key="thankYouText">Your generosity has made a real difference today. We’ve sent a confirmation to your email.</p>
            </div>
        </div>
    </div>


    <footer class="bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 py-10">
        <div class="container mx-auto px-6 text-center text-slate-600 dark:text-slate-400">
            <p>&copy; 2025 FairVend. All rights reserved. | Breaking barriers to essential goods.</p>
        </div>
    </footer>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Variable Declarations
            const html = document.documentElement;
            const languageModal = document.getElementById('language-modal');
            const settingsButton = document.getElementById('settings-button');
            const settingsDropdown = document.getElementById('settings-dropdown');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            const langSelectButtons = document.querySelectorAll('.lang-select-btn');
            const themeLightBtn = document.getElementById('theme-light-btn');
            const themeDarkBtn = document.getElementById('theme-dark-btn');
            const prevSlideBtn = document.getElementById('prev-slide');
            const nextSlideBtn = document.getElementById('next-slide');
            const sliderTrack = document.getElementById('slider-track');
            const donationForm = document.getElementById('donation-form');
            const donateBtn = document.getElementById('donate-btn');
            const donationAmountBtns = document.querySelectorAll('.donation-amount-btn');
            const customAmountInput = document.getElementById('custom-amount');
            const thankYouModal = document.getElementById('thank-you-modal');
            const thankYouContent = document.getElementById('thank-you-content');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const searchForm = document.getElementById('search-form');
            const locationInput = document.getElementById('location-input');
            const noLocationAlert = document.getElementById('no-location-alert');
            
            // Global state for current language
            let currentLang = localStorage.getItem('fairvendLang') || 'en';
            let slideIndex = 0;
            
            // Translations Data (omitted for brevity, assume the full translations object is here)
             const translations = {
                en: {
                    navHowItWorks: 'How It Works', navImpact: 'Impact', navFindMachine: 'Find Nearest Machine', navDonateNow: 'Donate Now', prefLang: 'Language', prefTheme: 'Theme', chooseLangTitle: 'Choose Your Language', chooseLangSubtitle: 'Please select your preferred language.', fundedAmount: '₹2.5M+ Funded', livesImpacted: '50,000+ Lives Impacted', heroTitle1: 'Breaking', heroTitle2: 'Barriers', heroTitle3: 'to Essential Goods', heroSubtitle: 'Color-coded discount cards connecting those in need to affordable essentials. Your donation helps us provide up to 50% discounts at vending machines across the community.', heroBtnFind: 'Find Nearest Machine', heroBtnDonate: 'Make a Donation', impactTitle: 'Our Collective Impact', impactSubtitle: 'Transparency is at the heart of what we do. See how your contributions are making a tangible difference in real-time.', impactFundsTitle: 'Total Funds Raised', impactFundsDesc: 'From thousands of generous donors across the country.', impactPeopleTitle: 'Individuals Supported', impactPeopleDesc: 'Provided with essential goods through our vending network.', testimonialsTitle: 'Stories from Our Community', testimonial1Text: '"As a student, every rupee matters. The FairVend card has been a blessing, helping me buy snacks and essentials without worrying. It feels like someone cares."', testimonial1Name: '- Ananya, Student from Mumbai', testimonial2Text: '"After a long day of work, having access to affordable drinks and sanitary products for my daughter is a huge relief. Thank you, FairVend, for your support."', testimonial2Name: '- Rajesh, Worker from Delhi', testimonial3Text: '"The dignity this program provides is immeasurable. Getting essentials for my family without feeling like I\'m asking for a handout has made all the difference."', testimonial3Name: '- Priya, Mother from Chennai', howTitle: 'A Simple System for a Big Impact', howSubtitle: 'We believe in direct, transparent, and dignified support. Here’s how our color-coded discount system works.', howStep1Title: 'Get Your Card', howStep1Desc: 'In partnership with local NGOs, we distribute FairVend cards. Each color represents a different level of support.', howStep2Title: 'Scan the Color', howStep2Desc: 'Simply show your card to the vending machine\'s scanner. Our system instantly recognizes and applies the discount.', howStep3Title: 'Receive Your Discount', howStep3Desc: 'Your discount is funded by generous donors, providing essential items at a more affordable price.', findTitle: 'Find a FairVend Machine Near You', findSubtitle: 'Enter your area or city to locate the closest machine and get directions.', searchPlaceholder: 'Enter city or landmark (e.g., Delhi, Central Park)', searchBtn: 'Search Location', donationTitle: 'Be The Change', donationSubtitle: 'Your donation today directly funds essential items for someone in need.', donateAmount: 'Select Donation Amount (INR)', customAmountPlaceholder: 'Custom Amount', donateName: 'Your Name', donateEmail: 'Your Email', captchaLabel: 'Enter the CAPTCHA Text', captchaPlaceholder: 'Type text here', donateBtnSecure: 'Donate Securely', thankYouTitle: 'Thank You!', thankYouText: 'Your generosity has made a real difference today. We’ve sent a confirmation to your email.', errorTitle: 'Error', errorText: 'Please fill in all fields correctly and ensure the CAPTCHA is correct.', navHowItWorks_mobile: 'How It Works', navImpact_mobile: 'Impact', navFindMachine_mobile: 'Find Nearest Machine',
                },
                hi: {
                    navHowItWorks: 'यह कैसे काम करता है', navImpact: 'प्रभाव', navFindMachine: 'निकटतम मशीन खोजें', navDonateNow: 'अभी दान करें', prefLang: 'भाषा', prefTheme: 'थीम', chooseLangTitle: 'अपनी भाषा चुनें', chooseLangSubtitle: 'कृपया अपनी पसंदीदा भाषा चुनें।', fundedAmount: '₹2.5M+ का वित्तपोषण', livesImpacted: '50,000+ लोगों पर प्रभाव', heroTitle1: 'आवश्यक वस्तुओं के लिए', heroTitle2: 'बाधाओं को तोड़ना', heroTitle3: '!', heroSubtitle: 'जरूरतमंदों को किफायती आवश्यक वस्तुओं से जोड़ने वाले रंग-कोडित डिस्काउंट कार्ड। आपका दान पूरे समुदाय में वेंडिंग मशीनों पर 50% तक की छूट प्रदान करने में हमारी मदद करता है।', heroBtnFind: 'निकटतम मशीन खोजें', heroBtnDonate: 'दान करें', impactTitle: 'हमारा सामूहिक प्रभाव', impactSubtitle: 'पारदर्शिता हमारे काम के केंद्र में है। देखें कि आपका योगदान वास्तविक समय में कैसे tangible बदलाव ला रहा है।', impactFundsTitle: 'कुल एकत्र किया गया धन', impactFundsDesc: 'देश भर के हजारों उदार दाताओं से।', impactPeopleTitle: 'समर्थित व्यक्ति', impactPeopleDesc: 'Provided with essential goods through our vending network.', testimonialsTitle: 'हमारे समुदाय की कहानियाँ', testimonial1Text: '"एक छात्र के रूप में, हर रुपया मायने रखता है। फेयरवेंड कार्ड एक वरदान रहा है, जिससे मुझे चिंता किए बिना स्नैक्स और आवश्यक चीजें खरीदने में मदद मिलती है। ऐसा लगता है कि किसी को परवाह है।"', testimonial1Name: '- अनन्या, मुंबई की छात्रा', testimonial2Text: '"काम के लंबे दिन के बाद, मेरी बेटी के लिए किफायती पेय और सैनिटरी उत्पादों तक पहुंच होना एक बड़ी राहत है। आपके समर्थन के लिए धन्यवाद, फेयरवेंड।"', testimonial2Name: '- राजेश, दिल्ली के कर्मचारी', testimonial3Text: '"यह कार्यक्रम जो गरिमा प्रदान करता है वह अमूल्य है। बिना यह महसूस किए कि मैं भीख मांग रहा हूं, अपने परिवार के लिए आवश्यक चीजें प्राप्त करना ही सब कुछ बदल दिया है।"', testimonial3Name: '- प्रिया, चेन्नई की माँ', howTitle: 'एक बड़े प्रभाव के लिए एक सरल प्रणाली', howSubtitle: 'हम सीधे, पारदर्शी और गरिमापूर्ण समर्थन में विश्वास करते हैं। यहां बताया गया है कि हमारी रंग-कोडित छूट प्रणाली कैसे काम करती है।', howStep1Title: 'अपना कार्ड प्राप्त करें', howStep1Desc: 'स्थानीय गैर सरकारी संगठनों के साथ साझेदारी में, हम फेयरवेंड कार्ड वितरित करते हैं। प्रत्येक रंग समर्थन के एक अलग स्तर का प्रतिनिधित्व करता है।', howStep2Title: 'रंग स्कैन करें', howStep2Desc: 'बस वेंडिंग मशीन के स्कैनर को अपना कार्ड दिखाएं। हमारा सिस्टम तुरंत छूट को पहचानता है और लागू करता है।', howStep3Title: 'अपनी छूट प्राप्त करें', howStep3Desc: 'आपकी छूट उदार दाताओं द्वारा वित्त पोषित है, जो अधिक किफायती मूल्य पर आवश्यक वस्तुएं प्रदान करती है।', findTitle: 'अपने पास एक फेयरवेंड मशीन खोजें', findSubtitle: 'निकटतम मशीन का पता लगाने और दिशा-निर्देश प्राप्त करने के लिए अपना क्षेत्र या शहर दर्ज करें।', searchPlaceholder: 'शहर या लैंडमार्क दर्ज करें (जैसे, दिल्ली, सेंट्रल पार्क)', searchBtn: 'स्थान खोजें', donationTitle: 'बदलाव बनें', donationSubtitle: 'आपका दान आज सीधे जरूरतमंद व्यक्ति के लिए आवश्यक वस्तुओं का वित्तपोषण करता है।', donateAmount: 'दान की राशि चुनें (INR)', customAmountPlaceholder: 'कस्टम राशि', donateName: 'आपका नाम', donateEmail: 'आपका ईमेल', captchaLabel: 'CAPTCHA टेक्स्ट दर्ज करें', captchaPlaceholder: 'यहां टेक्स्ट टाइप करें', donateBtnSecure: 'सुरक्षित रूप से दान करें', thankYouTitle: 'धन्यवाद!', thankYouText: 'आपकी उदारता ने आज एक वास्तविक बदलाव किया है। हमने आपके ईमेल पर एक पुष्टि भेजी है।', errorTitle: 'त्रुटि', errorText: 'कृपया सभी फ़ील्ड सही ढंग से भरें और सुनिश्चित करें कि CAPTCHA सही है।', navHowItWorks_mobile: 'यह कैसे काम करता है', navImpact_mobile: 'प्रभाव', navFindMachine_mobile: 'निकटतम मशीन खोजें',
                },
                ta: {
                    navHowItWorks: 'இது எவ்வாறு இயங்குகிறது', navImpact: 'தாக்கம்', navFindMachine: 'அருகிலுள்ள இயந்திரத்தைக் கண்டறியவும்', navDonateNow: 'இப்போது நன்கொடை அளிக்கவும்', prefLang: 'மொழி', prefTheme: 'தீம்', chooseLangTitle: 'உங்கள் மொழியைத் தேர்ந்தெடுக்கவும்', chooseLangSubtitle: 'தயவுசெய்து நீங்கள் விரும்பும் மொழியைத் தேர்ந்தெடுக்கவும்.', fundedAmount: '₹2.5M+ நிதி திரட்டப்பட்டது', livesImpacted: '50,000+ உயிர்களுக்கு உதவப்பட்டது', heroTitle1: 'அத்தியாவசியப் பொருட்களுக்கான', heroTitle2: 'தடைகளை உடைத்தல்', heroTitle3: '!', heroSubtitle: 'தேவையுள்ளவர்களை மலிவு விலையில் அத்தியாவசியப் பொருட்களுடன் இணைக்கும் வண்ண-குறியிடப்பட்ட தள்ளுபடி அட்டைகள். சமூகத்தில் உள்ள வெண்டிங் இயந்திரங்களில் 50% வரை தள்ளுபடிகளை வழங்க உங்கள் நன்கொடை எங்களுக்கு உதவுகிறது.', heroBtnFind: 'அருகிலுள்ள இயந்திரத்தைக் கண்டறியவும்', heroBtnDonate: 'நன்கொடை அளிக்கவும்', impactTitle: 'எங்கள் கூட்டுத் தாக்கம்', impactSubtitle: 'வெளிப்படைத்தன்மை எங்கள் பணியின் மையத்தில் உள்ளது. உங்கள் பங்களிப்புகள் நிகழ்நேரத்தில் எவ்வாறு உறுதியான வித்தியாசத்தை ஏற்படுத்துகின்றன என்பதைப் பாருங்கள்.', impactFundsTitle: 'மொத்தமாகத் திரட்டப்பட்ட நிதி', impactFundsDesc: 'நாடு முழுவதும் உள்ள ஆயிரக்கணக்கான தாராள மனப்பான்மை கொண்ட நன்கொடையாளர்களிடமிருந்து.', impactPeopleTitle: 'ஆதரவளிக்கப்பட்ட தனிநபர்கள்', impactPeopleDesc: 'எங்கள் வெண்டிங் நெட்வொர்க் மூலம் அத்தியாவசியப் பொருட்கள் வழங்கப்பட்டன.', testimonialsTitle: 'எங்கள் சமூகத்திலிருந்து கதைகள்', testimonial1Text: '"ஒரு மாணவியாக, ஒவ்வொரு ரூபாயும் முக்கியம். ஃபேர்வென்ட் அட்டை ஒரு வரப்பிரசாதமாக உள்ளது, கவலைப்படாமல் தின்பண்டங்கள் மற்றும் அத்தியாவசியப் பொருட்களை வாங்க எனக்கு உதவுகிறது. யாரோ கவலைப்படுகிறார்கள் போல் உணர்கிறேன்."', testimonial1Name: '- அனன்யா, மும்பை மாணவி', testimonial2Text: '"நீண்ட நாள் வேலைக்குப் பிறகு, என் மகளுக்கு மலிவு விலையில் பானங்கள் மற்றும் சுகாதாரப் பொருட்களை அணுகுவது ஒரு பெரிய நிவாரணம். உங்கள் ஆதரவுக்கு நன்றி, ஃபேர்வென்ட்."', testimonial2Name: '- ராஜேஷ், டெல்லியைச் சேர்ந்த தொழிலாளி', testimonial3Text: '"இந்த திட்டம் வழங்கும் கண்ணியம் அளவிட முடியாதது. நான் யாசகம் கேட்பது போல் உணராமல் என் குடும்பத்திற்கு அத்தியாவசியப் பொருட்களைப் பெறுவது எல்லா வித்தியாசத்தையும் ஏற்படுத்தியுள்ளது."', testimonial3Name: '- பிரியா, சென்னையைச் சேர்ந்த தாய்', howTitle: 'ஒரு பெரிய தாக்கத்திற்கான எளிய அமைப்பு', howSubtitle: 'நாங்கள் நேரடியான, வெளிப்படையான மற்றும் கண்ணியமான ஆதரவை நம்புகிறோம். எங்கள் வண்ண-குறியிடப்பட்ட தள்ளுபடி அமைப்பு எவ்வாறு இயங்குகிறது என்பது இங்கே.', howStep1Title: 'உங்கள் அட்டையைப் பெறுங்கள்', howStep1Desc: 'உள்ளூர் தன்னார்வ தொண்டு நிறுவனங்களுடன் இணைந்து, நாங்கள் ஃபேர்வென்ட் அட்டைகளை விநியோகிக்கிறோம். ஒவ்வொரு வண்ணமும் ஒரு வித்தியாசமான ஆதரவு நிலையைக் குறிக்கிறது.', howStep2Title: 'வண்ணத்தை ஸ்கேன் செய்யுங்கள்', howStep2Desc: 'வெண்டிங் இயந்திரத்தின் ஸ்கேனரில் உங்கள் அட்டையைக் காட்டுங்கள். எங்கள் அமைப்பு உடனடியாக தள்ளுபடியை அடையாளம் கண்டு பயன்படுத்துகிறது.', howStep3Title: 'உங்கள் தள்ளுபடியைப் பெறுங்கள்', howStep3Desc: 'உங்கள் தள்ளுபடி தாராள மனப்பான்மை கொண்ட நன்கொடையாளர்களால் நிதியளிக்கப்படுகிறது, இது அத்தியாவசியப் பொருட்களை மிகவும் மலிவு விலையில் வழங்குகிறது.', findTitle: 'உங்களுக்கு அருகிலுள்ள ஃபேர்வென்ட் இயந்திரத்தைக் கண்டறியவும்', findSubtitle: 'அருகிலுள்ள இயந்திரத்தைக் கண்டறியவும் மற்றும் திசைகளைப் பெறவும் உங்கள் பகுதி அல்லது நகரத்தை உள்ளிடவும்.', searchPlaceholder: 'நகரம் அல்லது அடையாளத்தை உள்ளிடவும் (எ.கா., டெல்லி, சென்ட்ரல் பார்க்)', searchBtn: 'இடத்தைத் தேடவும்', donationTitle: 'மாற்றமாக இருங்கள்', donationSubtitle: 'உங்கள் நன்கொடை இன்று தேவையுள்ள ஒருவருக்கு அத்தியாவசியப் பொருட்களுக்கு நேரடியாக நிதியளிக்கிறது।', donateAmount: 'நன்கொடைத் தொகையைத் தேர்ந்தெடுக்கவும் (INR)', customAmountPlaceholder: 'தனிப்பயன் தொகை', donateName: 'உங்கள் பெயர்', donateEmail: 'உங்கள் மின்னஞ்சல்', captchaLabel: 'CAPTCHA உரையை உள்ளிடவும்', captchaPlaceholder: 'இங்கே உரையைத் தட்டச்சு செய்க', donateBtnSecure: 'பாதுகாப்பாக நன்கொடை அளிக்கவும்', thankYouTitle: 'நன்றி!', thankYouText: 'உங்கள் தாராள மனப்பான்மை இன்று ஒரு உண்மையான வித்தியாசத்தை ஏற்படுத்தியுள்ளது. உங்கள் மின்னஞ்சலுக்கு நாங்கள் உறுதிப்படுத்தலை அனுப்பியுள்ளோம்।', errorTitle: 'பிழை', errorText: 'தயவுசெய்து அனைத்து புலங்களையும் சரியாக நிரப்பவும் மற்றும் CAPTCHA சரியாக உள்ளதா என்பதை உறுதிப்படுத்தவும்।', navHowItWorks_mobile: 'இது எவ்வாறு இயங்குகிறது', navImpact_mobile: 'தாக்கம்', navFindMachine_mobile: 'அருகிலுள்ள இயந்திரத்தைக் கண்டறியவும்',
                }
            };
            
            // --- Utility Functions ---
            
            const showModal = (content) => {
                thankYouContent.innerHTML = content;
                thankYouModal.classList.remove('hidden');
            };

            const hideModal = () => {
                thankYouModal.classList.add('hidden');
            };

            const generateCaptcha = () => {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
                let captcha = '';
                for (let i = 0; i < 6; i++) {
                    captcha += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                document.getElementById('captcha-text').textContent = captcha;
            };
            
            // --- Translation Functions ---
            const updateContent = (lang) => {
                document.querySelectorAll('[data-key]').forEach(element => {
                    const key = element.getAttribute('data-key');
                    if (translations[lang] && translations[lang][key]) {
                        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                            element.placeholder = translations[lang][key];
                        } else {
                            element.textContent = translations[lang][key];
                        }
                    }
                });
                
                // Specific updates for buttons in the header that don't use data-key for text
                document.getElementById('header-find-machine-btn-desktop').textContent = translations[lang].navFindMachine;
                document.getElementById('header-find-machine-btn-mobile').textContent = translations[lang].navFindMachine_mobile;
                document.getElementById('location-input').placeholder = translations[lang].searchPlaceholder;
            };
            
            const setLanguage = (lang) => {
                currentLang = lang;
                localStorage.setItem('fairvendLang', lang);
                updateContent(lang);
                languageModal.classList.add('hidden');
            };

            // --- Theme Functions (FIXED & IMPROVED) ---

            // Function to visually mark the active theme button
            const updateThemeSelector = (activeTheme) => {
                // Class for visual highlight on selected theme button
                const activeClass = 'bg-slate-200 dark:bg-slate-700'; 
                
                themeLightBtn.classList.remove(activeClass);
                themeDarkBtn.classList.remove(activeClass);

                if (activeTheme === 'dark') {
                    themeDarkBtn.classList.add(activeClass);
                } else {
                    themeLightBtn.classList.add(activeClass);
                }
            };

            const initTheme = () => {
                const storedTheme = localStorage.getItem('theme');
                const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                let finalTheme; 

                if (storedTheme === 'dark' || (!storedTheme && systemPrefersDark)) {
                    html.classList.add('dark');
                    finalTheme = 'dark';
                } else {
                    html.classList.remove('dark');
                    finalTheme = 'light';
                }
                
                // Apply visual feedback for the selected theme
                updateThemeSelector(finalTheme);
            };

            const toggleTheme = (theme) => {
                if (theme === 'dark') {
                    html.classList.add('dark');
                    localStorage.setItem('theme', 'dark');
                } else {
                    html.classList.remove('dark');
                    localStorage.setItem('theme', 'light');
                }
                
                // Update visual feedback
                updateThemeSelector(theme);
                
                // Close settings dropdown after theme selection
                settingsDropdown.classList.add('hidden');
            };

            // --- Slider Functions ---
            const updateSlider = () => {
                if (sliderTrack.children.length > 0) {
                    const slideWidth = sliderTrack.children[0].offsetWidth;
                    sliderTrack.style.transform = `translateX(-${slideIndex * slideWidth}px)`;
                }
            };
            
            // --- Map Functions ---
            let map;
            const markerLayer = L.layerGroup();
            
            // Initialize map
            try {
                map = L.map('map').setView([20.5937, 78.9629], 5); // Center on India
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    maxZoom: 19,
                    attribution: '© OpenStreetMap contributors'
                }).addTo(map);
                markerLayer.addTo(map);

                // Add a simple user location marker (simulated for demonstration)
                L.marker([28.7041, 77.1025], { // Delhi
                    icon: L.divIcon({
                        className: 'user-location-marker',
                        html: '<svg class="w-8 h-8 text-red-600" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5s2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>',
                        iconSize: [32, 32],
                        iconAnchor: [16, 32]
                    })
                }).addTo(markerLayer).bindPopup("Your Location (Simulated)");


                // Mock data for FairVend machines (cities in India)
                const machineLocations = [
                    { lat: 28.6139, lon: 77.2090, city: "New Delhi", count: 12 },
                    { lat: 19.0760, lon: 72.8777, city: "Mumbai", count: 8 },
                    { lat: 13.0827, lon: 80.2707, city: "Chennai", count: 5 },
                    { lat: 22.5726, lon: 88.3639, city: "Kolkata", count: 7 },
                    { lat: 12.9716, lon: 77.5946, city: "Bangalore", count: 10 }
                ];

                // Add machine markers
                machineLocations.forEach(loc => {
                    L.marker([loc.lat, loc.lon]).addTo(markerLayer)
                        .bindPopup(`<b>FairVend Machine (${loc.city})</b><br>${loc.count} machines nearby.`);
                });
                
                // Search functionality (Mock)
                searchForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const locationName = locationInput.value.toLowerCase().trim();
                    noLocationAlert.classList.add('hidden');
                    
                    const foundLocation = machineLocations.find(loc => loc.city.toLowerCase() === locationName);
                    
                    if (foundLocation) {
                        map.setView([foundLocation.lat, foundLocation.lon], 12);
                    } else if (locationName === 'delhi' || locationName === 'new delhi') {
                        // Special case for Delhi to center near the main cluster if exact match is missed
                        map.setView([28.6139, 77.2090], 12);
                    } else {
                        noLocationAlert.classList.remove('hidden');
                    }
                });


            } catch (error) {
                console.error("Leaflet map initialization failed:", error);
                // Optionally show a fallback message in the map div
                const mapDiv = document.getElementById('map');
                if (mapDiv) {
                    mapDiv.innerHTML = '<p class="text-center p-4 text-red-500 dark:text-red-300">Map failed to load. Please check your network connection.</p>';
                }
            }


            // --- Event Listeners ---
            
            // 1. Initialize translations based on current preference (must happen before showing modal)
            updateContent(currentLang);

            // 2. Always show the Language Selection Modal as requested by the user
            languageModal.classList.remove('hidden');
            
            // Language selection handlers
            langSelectButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const lang = button.getAttribute('data-lang');
                    setLanguage(lang);
                    settingsDropdown.classList.add('hidden'); // Close settings if selected from there
                });
            });

            // Header scroll effect
            const header = document.querySelector('header');
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) {
                    header.classList.add('header-scrolled');
                } else {
                    header.classList.remove('header-scrolled');
                }
            });

            // Settings dropdown toggle
            settingsButton.addEventListener('click', (event) => {
                settingsDropdown.classList.toggle('hidden');
                event.stopPropagation();
            });

            document.addEventListener('click', (event) => {
                // Only hide if the click is outside the button AND outside the dropdown
                if (!settingsDropdown.contains(event.target) && event.target !== settingsButton) {
                    settingsDropdown.classList.add('hidden');
                }
            });
            
            // Mobile menu toggle
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            // Theme switch (FIXED/IMPROVED)
            themeLightBtn.addEventListener('click', () => toggleTheme('light'));
            themeDarkBtn.addEventListener('click', () => toggleTheme('dark'));

            // Testimonials slider controls
            prevSlideBtn.addEventListener('click', () => {
                slideIndex = (slideIndex > 0) ? slideIndex - 1 : sliderTrack.children.length - 1;
                updateSlider();
            });

            nextSlideBtn.addEventListener('click', () => {
                slideIndex = (slideIndex < sliderTrack.children.length - 1) ? slideIndex + 1 : 0;
                updateSlider();
            });

            // Recalculate slider position on window resize
            window.addEventListener('resize', updateSlider);

            // Form validation and submission
            donationForm.addEventListener('submit', (e) => {
                e.preventDefault();

                const name = document.getElementById('donor-name').value.trim();
                const email = document.getElementById('donor-email').value.trim();
                const enteredCaptcha = document.getElementById('captcha-input').value.trim();
                const correctCaptcha = document.getElementById('captcha-text').textContent;
                
                // Get selected amount, check both buttons and custom input
                let selectedAmount = document.querySelector('.donation-amount-btn.bg-indigo-600, .donation-amount-btn.ring-2')?.value; 
                if (!selectedAmount) {
                     selectedAmount = customAmountInput.value;
                }
                const amount = parseFloat(selectedAmount);

                if (!name || !email || !amount || enteredCaptcha !== correctCaptcha) {
                    const errorContent = `
                        <h3 class="text-2xl font-bold text-red-600 dark:text-red-400" data-key="errorTitle">${translations[currentLang].errorTitle}</h3>
                        <p class="mt-2 text-slate-600 dark:text-slate-300" data-key="errorText">${translations[currentLang].errorText}</p>
                    `;
                    showModal(errorContent);
                    return;
                }

                // Simulate secure payment processing (e.g., calling a server API)
                donateBtn.disabled = true;
                donateBtn.innerHTML = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>${translations[currentLang].donateBtnSecure}`;
                
                // Simulate a delay for payment processing
                setTimeout(() => {
                   
                   const lang = currentLang;
                   const thankYouTemplate = {
                        en: `Dear ${name.split(' ')[0]}, thank you for your generous donation of ₹${amount}. Your contribution directly funds essential goods, **breaking down barriers** for families in need. You're making a real difference!`,
                        hi: `प्रिय ${name.split(' ')[0]}, ₹${amount} के आपके उदार दान के लिए धन्यवाद। आपका योगदान सीधे आवश्यक वस्तुओं को निधि देता है, **जरूरतमंद परिवारों के लिए बाधाओं को तोड़ता है**। आप एक वास्तविक बदलाव ला रहे हैं!`,
                        ta: `அன்புள்ள ${name.split(' ')[0]}, ₹${amount} நன்கொடை அளித்ததற்கு நன்றி. உங்கள் பங்களிப்பு அத்தியாவசியப் பொருட்களுக்கு நேரடியாக நிதியளிக்கிறது, **தேவையுள்ள குடும்பங்களுக்கான தடைகளை உடைக்கிறது**। நீங்கள் ஒரு உண்மையான மாற்றத்தை உருவாக்குகிறீர்கள்!`
                   }[lang];

                   const thankYouNote = thankYouTemplate; 
                   
                   // Update modal and reset form
                   showModal(thankYouNote);
                   donationForm.reset();
                   // Remove all selection styles from donation buttons
                   donationAmountBtns.forEach(b => b.classList.remove(
                       'bg-indigo-600', 'text-white', 'hover:bg-indigo-700',
                       'ring-2', 'ring-indigo-300', 'dark:bg-indigo-900'
                   ));
                   generateCaptcha();
                   donateBtn.disabled = false;
                   donateBtn.innerHTML = translations[lang].donateBtnSecure;

                }, 1500); // 1.5 second delay simulation
            });

            // Amount button selection logic (Cleaned up)
            donationAmountBtns.forEach(button => {
                button.addEventListener('click', () => {
                    // Remove selection styles from all
                    donationAmountBtns.forEach(b => b.classList.remove(
                        'bg-indigo-600', 'text-white', 'hover:bg-indigo-700', 
                        'ring-2', 'ring-indigo-300', 'dark:bg-indigo-900'
                    ));
                    
                    // Add selection styles to the clicked button
                    button.classList.add(
                        'bg-indigo-600', 'text-white', 'hover:bg-indigo-700'
                    );
                    customAmountInput.value = ''; // Clear custom input
                });
            });

            customAmountInput.addEventListener('input', () => {
                // Remove selection styles from all buttons when custom input is used
                donationAmountBtns.forEach(b => b.classList.remove(
                    'bg-indigo-600', 'text-white', 'hover:bg-indigo-700', 
                    'ring-2', 'ring-indigo-300', 'dark:bg-indigo-900'
                ));
            });

            closeModalBtn.addEventListener('click', hideModal);
            thankYouModal.addEventListener('click', (e) => { if (e.target === thankYouModal) hideModal(); });
            
            // --- Initializations ---
            initTheme();
            generateCaptcha();
            updateSlider(); // Initial slider positioning
        });
    </script>

</body>
</html>
